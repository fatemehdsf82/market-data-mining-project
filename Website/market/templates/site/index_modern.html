{% extends "site/base_modern.html" %}
{% block title %}Analytics Dashboard - Market Intelligence Platform{% endblock %}

{% block extrahead %}
<style>
    /* Dashboard-specific styles */
    .hero-section {
        background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
        color: white;
        padding: var(--space-2xl) 0;
        margin: calc(var(--space-xl) * -1) calc(var(--space-md) * -1) var(--space-xl);
        border-radius: 0 0 var(--border-radius-xl) var(--border-radius-xl);
        position: relative;
        overflow: hidden;
    }
    
    .hero-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
        opacity: 0.3;
    }
    
    .hero-content {
        position: relative;
        z-index: 2;
    }
    
    .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: var(--space-lg);
        margin-bottom: var(--space-2xl);
    }
    
    .analytics-card {
        background: white;
        border-radius: var(--border-radius-lg);
        padding: var(--space-lg);
        box-shadow: var(--shadow-md);
        transition: var(--transition-slow);
        border: 1px solid var(--gray-200);
        position: relative;
        overflow: hidden;
    }
    
    .analytics-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--primary), var(--accent));
    }
    
    .analytics-card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-xl);
    }
    
    .card-icon {
        width: 60px;
        height: 60px;
        border-radius: var(--border-radius-lg);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: white;
        margin-bottom: var(--space-md);
    }
    
    .icon-primary { background: linear-gradient(135deg, var(--primary), var(--primary-dark)); }
    .icon-success { background: linear-gradient(135deg, var(--success), #059669); }
    .icon-info { background: linear-gradient(135deg, var(--info), #1d4ed8); }
    .icon-warning { background: linear-gradient(135deg, var(--warning), #d97706); }
    
    .chart-container {
        background: white;
        border-radius: var(--border-radius-lg);
        padding: var(--space-lg);
        box-shadow: var(--shadow-md);
        margin-bottom: var(--space-xl);
        border: 1px solid var(--gray-200);
    }
    
    .chart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--space-lg);
    }
    
    .chart-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--gray-900);
        margin: 0;
    }
    
    .chart-controls {
        display: flex;
        gap: var(--space-sm);
    }
    
    .chart-btn {
        padding: 0.5rem 1rem;
        border: 1px solid var(--gray-300);
        background: white;
        border-radius: var(--border-radius);
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: var(--transition);
    }
    
    .chart-btn:hover,
    .chart-btn.active {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
    }
    
    .insights-panel {
        background: linear-gradient(135deg, var(--gray-50) 0%, white 100%);
        border-radius: var(--border-radius-lg);
        padding: var(--space-lg);
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--gray-200);
    }
    
    .insight-item {
        display: flex;
        align-items: center;
        padding: var(--space-md);
        border-radius: var(--border-radius);
        margin-bottom: var(--space-sm);
        transition: var(--transition);
    }
    
    .insight-item:hover {
        background: rgba(99, 102, 241, 0.05);
    }
    
    .insight-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: var(--space-md);
        font-size: 1rem;
    }
    
    .quick-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--space-md);
        margin-top: var(--space-xl);
    }
    
    .action-btn {
        background: white;
        border: 2px solid var(--gray-200);
        border-radius: var(--border-radius-lg);
        padding: var(--space-lg);
        text-align: center;
        text-decoration: none;
        color: var(--gray-700);
        transition: var(--transition-slow);
        position: relative;
        overflow: hidden;
    }
    
    .action-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);
        transition: left 0.5s ease;
    }
    
    .action-btn:hover::before {
        left: 100%;
    }
    
    .action-btn:hover {
        border-color: var(--primary);
        color: var(--primary);
        transform: translateY(-4px);
        box-shadow: var(--shadow-lg);
    }
    
    @media (max-width: 768px) {
        .dashboard-grid {
            grid-template-columns: 1fr;
        }
        
        .hero-section {
            padding: var(--space-xl) 0;
        }
        
        .chart-header {
            flex-direction: column;
            gap: var(--space-md);
        }
    }
    
    /* Dark theme adjustments */
    [data-theme="dark"] .analytics-card,
    [data-theme="dark"] .chart-container {
        background: var(--gray-100);
        border-color: var(--gray-200);
    }
    
    [data-theme="dark"] .chart-title {
        color: var(--gray-900);
    }
    
    [data-theme="dark"] .insights-panel {
        background: var(--gray-100);
        border-color: var(--gray-200);
    }
    
    [data-theme="dark"] .action-btn {
        background: var(--gray-100);
        border-color: var(--gray-200);
        color: var(--gray-700);
    }
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="hero-section">
    <div class="hero-content text-center">
        <h1 class="display-4 fw-bold mb-3">Market Intelligence Dashboard</h1>
        <p class="lead mb-4">Real-time analytics and insights for data-driven decision making</p>
        <div class="d-flex justify-content-center gap-3">
            <span class="badge bg-light text-primary px-3 py-2">Live Data</span>
            <span class="badge bg-light text-primary px-3 py-2">1M+ Transactions</span>
            <span class="badge bg-light text-primary px-3 py-2">Advanced ML</span>
        </div>
    </div>
</div>

<!-- Key Metrics -->
<div class="dashboard-grid animate-on-scroll">
    <div class="metric-card">
        <div class="metric-value" data-count="1048569">0</div>
        <div class="metric-label">Total Transactions</div>
        <div class="metric-change positive">
            <i class="fas fa-arrow-up me-1"></i>+12.5% vs last month
        </div>
    </div>
    
    <div class="metric-card">
        <div class="metric-value" data-count="92353">0</div>
        <div class="metric-label">Unique Products</div>
        <div class="metric-change positive">
            <i class="fas fa-arrow-up me-1"></i>+8.2% vs last month
        </div>
    </div>
    
    <div class="metric-card">
        <div class="metric-value" data-count="2497">0</div>
        <div class="metric-label">Active Customers</div>
        <div class="metric-change positive">
            <i class="fas fa-arrow-up me-1"></i>+15.3% vs last month
        </div>
    </div>
    
    <div class="metric-card">
        <div class="metric-value">$2.8M</div>
        <div class="metric-label">Total Revenue</div>
        <div class="metric-change positive">
            <i class="fas fa-arrow-up me-1"></i>+18.7% vs last month
        </div>
    </div>
</div>

<!-- Analytics Tools -->
<div class="row mb-5">
    <div class="col-12">
        <h2 class="h3 fw-bold mb-4">
            <i class="fas fa-tools me-2"></i>Analytics Tools
        </h2>
    </div>
</div>

<div class="dashboard-grid animate-on-scroll">
    <a href="/analysis/basket-analysis/" class="analytics-card text-decoration-none">
        <div class="card-icon icon-primary">
            <i class="fas fa-shopping-basket"></i>
        </div>
        <h3 class="h5 fw-bold text-dark mb-2">Shopping Basket Analysis</h3>
        <p class="text-muted mb-3">Analyze shopping patterns, popular products, and purchase behaviors with advanced market basket algorithms.</p>
        <div class="d-flex align-items-center text-primary">
            <span class="fw-semibold">Launch Analysis</span>
            <i class="fas fa-arrow-right ms-2"></i>
        </div>
    </a>
    
    <a href="/analysis/association-rules/" class="analytics-card text-decoration-none">
        <div class="card-icon icon-success">
            <i class="fas fa-network-wired"></i>
        </div>
        <h3 class="h5 fw-bold text-dark mb-2">Association Rules Mining</h3>
        <p class="text-muted mb-3">Discover product relationships and generate actionable insights using advanced Apriori algorithms.</p>
        <div class="d-flex align-items-center text-primary">
            <span class="fw-semibold">Mine Rules</span>
            <i class="fas fa-arrow-right ms-2"></i>
        </div>
    </a>
    
    <a href="/analysis/customer-segments/" class="analytics-card text-decoration-none">
        <div class="card-icon icon-info">
            <i class="fas fa-users"></i>
        </div>
        <h3 class="h5 fw-bold text-dark mb-2">Customer Segmentation</h3>
        <p class="text-muted mb-3">Perform RFM analysis and create behavioral segments for targeted marketing strategies.</p>
        <div class="d-flex align-items-center text-primary">
            <span class="fw-semibold">Analyze Customers</span>
            <i class="fas fa-arrow-right ms-2"></i>
        </div>
    </a>
    
    <a href="/analysis/data-management/" class="analytics-card text-decoration-none">
        <div class="card-icon icon-warning">
            <i class="fas fa-database"></i>
        </div>
        <h3 class="h5 fw-bold text-dark mb-2">Data Management</h3>
        <p class="text-muted mb-3">Advanced database operations, data quality management, and analytics preparation tools.</p>
        <div class="d-flex align-items-center text-primary">
            <span class="fw-semibold">Manage Data</span>
            <i class="fas fa-arrow-right ms-2"></i>
        </div>
    </a>
</div>

<!-- Chart Section -->
<div class="chart-container animate-on-scroll">
    <div class="chart-header">
        <h3 class="chart-title">
            <i class="fas fa-chart-line me-2"></i>Market Trends Overview
        </h3>
        <div class="chart-controls">
            <button class="chart-btn active" data-period="week">Week</button>
            <button class="chart-btn" data-period="month">Month</button>
            <button class="chart-btn" data-period="quarter">Quarter</button>
        </div>
    </div>
    <div style="height: 400px;">
        <canvas id="trendsChart"></canvas>
    </div>
</div>

<!-- Insights and Quick Actions -->
<div class="row">
    <div class="col-lg-8">
        <div class="insights-panel animate-on-scroll">
            <h3 class="h5 fw-bold mb-4">
                <i class="fas fa-lightbulb me-2"></i>Key Insights
            </h3>
            
            <div class="insight-item">
                <div class="insight-icon bg-success text-white">
                    <i class="fas fa-arrow-up"></i>
                </div>
                <div>
                    <div class="fw-semibold">Revenue Growth</div>
                    <div class="text-muted small">Sales increased by 18.7% compared to last month</div>
                </div>
            </div>
            
            <div class="insight-item">
                <div class="insight-icon bg-info text-white">
                    <i class="fas fa-users"></i>
                </div>
                <div>
                    <div class="fw-semibold">Customer Acquisition</div>
                    <div class="text-muted small">315 new customers acquired this week</div>
                </div>
            </div>
            
            <div class="insight-item">
                <div class="insight-icon bg-warning text-white">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <div>
                    <div class="fw-semibold">Top Category</div>
                    <div class="text-muted small">Grocery items showing 25% increase in demand</div>
                </div>
            </div>
            
            <div class="insight-item">
                <div class="insight-icon bg-primary text-white">
                    <i class="fas fa-clock"></i>
                </div>
                <div>
                    <div class="fw-semibold">Peak Hours</div>
                    <div class="text-muted small">Highest activity between 6-8 PM on weekdays</div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <div class="animate-on-scroll">
            <h3 class="h5 fw-bold mb-4">
                <i class="fas fa-rocket me-2"></i>Quick Actions
            </h3>
            
            <div class="quick-actions">
                <a href="/analysis/association-rules/" class="action-btn">
                    <i class="fas fa-magic d-block mb-2 fs-4"></i>
                    <div class="fw-semibold">Generate Rules</div>
                </a>
                
                <a href="/analysis/customer-segments/" class="action-btn">
                    <i class="fas fa-chart-pie d-block mb-2 fs-4"></i>
                    <div class="fw-semibold">Segment Analysis</div>
                </a>
                
                <a href="/analysis/data-management/" class="action-btn">
                    <i class="fas fa-download d-block mb-2 fs-4"></i>
                    <div class="fw-semibold">Export Data</div>
                </a>
                
                <a href="/analysis/basket-analysis/" class="action-btn">
                    <i class="fas fa-search d-block mb-2 fs-4"></i>
                    <div class="fw-semibold">Deep Dive</div>
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block footer %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Animate counter numbers
    function animateCounter(element) {
        const target = parseInt(element.dataset.count);
        const duration = 2000;
        const start = performance.now();
        
        function updateCounter(currentTime) {
            const elapsed = currentTime - start;
            const progress = Math.min(elapsed / duration, 1);
            
            const current = Math.floor(progress * target);
            element.textContent = current.toLocaleString();
            
            if (progress < 1) {
                requestAnimationFrame(updateCounter);
            }
        }
        
        requestAnimationFrame(updateCounter);
    }
    
    // Start counter animations when elements come into view
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const counter = entry.target.querySelector('[data-count]');
                if (counter && !counter.classList.contains('animated')) {
                    counter.classList.add('animated');
                    animateCounter(counter);
                }
            }
        });
    });
    
    document.querySelectorAll('.metric-card').forEach(card => {
        observer.observe(card);
    });
    
    // Chart initialization
    const ctx = document.getElementById('trendsChart');
    if (ctx) {
        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [{
                    label: 'Sales Volume',
                    data: [65, 78, 90, 81, 95, 108, 125, 140, 135, 150, 165, 180],
                    borderColor: 'rgb(99, 102, 241)',
                    backgroundColor: 'rgba(99, 102, 241, 0.1)',
                    tension: 0.4,
                    fill: true,
                    pointBackgroundColor: 'rgb(99, 102, 241)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointRadius: 6,
                    pointHoverRadius: 8
                }, {
                    label: 'Customer Acquisition',
                    data: [28, 35, 42, 48, 52, 61, 70, 75, 82, 90, 95, 105],
                    borderColor: 'rgb(16, 185, 129)',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    tension: 0.4,
                    fill: true,
                    pointBackgroundColor: 'rgb(16, 185, 129)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointRadius: 6,
                    pointHoverRadius: 8
                }, {
                    label: 'Revenue (x$1000)',
                    data: [120, 140, 160, 155, 180, 200, 230, 250, 245, 270, 290, 315],
                    borderColor: 'rgb(6, 182, 212)',
                    backgroundColor: 'rgba(6, 182, 212, 0.1)',
                    tension: 0.4,
                    fill: true,
                    pointBackgroundColor: 'rgb(6, 182, 212)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointRadius: 6,
                    pointHoverRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            usePointStyle: true,
                            padding: 20,
                            font: {
                                family: 'Inter',
                                weight: '500'
                            }
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: 'rgba(99, 102, 241, 0.3)',
                        borderWidth: 1,
                        cornerRadius: 8,
                        displayColors: true,
                        intersect: false,
                        mode: 'index'
                    }
                },
                scales: {
                    x: {
                        grid: {
                            display: false
                        },
                        ticks: {
                            font: {
                                family: 'Inter',
                                weight: '500'
                            }
                        }
                    },
                    y: {
                        grid: {
                            color: 'rgba(0, 0, 0, 0.05)'
                        },
                        ticks: {
                            font: {
                                family: 'Inter',
                                weight: '500'
                            }
                        }
                    }
                },
                interaction: {
                    intersect: false,
                    mode: 'index'
                },
                elements: {
                    point: {
                        hoverBorderWidth: 3
                    }
                }
            }
        });
        
        // Chart period controls
        document.querySelectorAll('.chart-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.chart-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Here you would update the chart data based on the selected period
                showNotification(`Chart updated to show ${this.dataset.period} view`, 'success');
            });
        });
    }
    
    // Add hover effects to analytics cards
    document.querySelectorAll('.analytics-card').forEach(card => {
        card.addEventListener('mouseenter', function() {
            gsap.to(this, {
                scale: 1.02,
                duration: 0.3,
                ease: "power2.out"
            });
        });
        
        card.addEventListener('mouseleave', function() {
            gsap.to(this, {
                scale: 1,
                duration: 0.3,
                ease: "power2.out"
            });
        });
    });
});
</script>
{% endblock %}